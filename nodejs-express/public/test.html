<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Joke API Tester</title>
		<style>
			body {
				font-family: Arial, sans-serif;
				max-width: 800px;
				margin: 50px auto;
				padding: 20px;
			}
			input,
			button {
				padding: 10px;
				margin: 10px 0;
				width: 100%;
				box-sizing: border-box;
			}
			pre {
				background: #f4f4f4;
				padding: 15px;
				border-radius: 5px;
				overflow-x: auto;
			}
			.error {
				color: red;
			}
			.success {
				color: green;
			}
		</style>
	</head>
	<body>
		<h1>Joke API Tester</h1>

		<div>
			<label for="token">JWT Token:</label>
			<input
				type="text"
				id="token"
				placeholder="Paste your JWT token here"
			/>
		</div>

		<div>
			<label for="endpoint">Endpoint:</label>
			<select id="endpoint">
				<option value="/api/jokes">Random Joke</option>
				<option value="/api/jokes/Programming">Programming Joke</option>
				<option value="/api/jokes/Pun">Pun Joke</option>
				<option value="/api/jokes/Misc">Misc Joke</option>
			</select>
		</div>

		<button onclick="fetchJoke()">Fetch Joke</button>

		<div id="result"></div>

		<script>
			async function fetchJoke() {
				const token = document.getElementById('token').value;
				const endpoint = document.getElementById('endpoint').value;
				const resultDiv = document.getElementById('result');

				if (!token) {
					resultDiv.innerHTML =
						'<p class="error">Please enter a JWT token!</p>';
					return;
				}

				try {
					const response = await fetch(
						`http://localhost:3000${endpoint}`,
						{
							headers: {
								Authorization: `Bearer ${token}`,
							},
						}
					);

					const data = await response.json();

					if (response.ok) {
						resultDiv.innerHTML = `
                        <h3 class="success">Success!</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
					} else {
						resultDiv.innerHTML = `
                        <h3 class="error">Error ${response.status}</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
					}
				} catch (error) {
					resultDiv.innerHTML = `
                    <h3 class="error">Error</h3>
                    <p>${error.message}</p>
                `;
				}
			}
		</script>
	</body>
</html>
